{"version":3,"sources":["modules/formControl.js","modules/alert.js","modules/collapse.js","modules/main.js","modules/modal.js","modules/spinner.js","modules/xhrPromise.js","modules/mediaUpload.js","media.js"],"names":["enableFormControl","control","disabled","disableFormControl","dismissAlertInlineMessage","event","target","dataset","dismiss","closest","remove","alertInlineMessage","severity","heading","message","container","document","createElement","innerHTML","pitonConfig","alertInlineHTML","querySelector","classList","add","join","insertAdjacentHTML","window","scrollTo","collapseToggle","collapse","collapseTarget","toggle","querySelectorAll","forEach","form","saveButtons","addEventListener","e","confirm","preventDefault","deletePrompt","modal","getElementById","getModal","showModal","showModalContent","header","body","hideModal","enableSpinner","contains","disableSpinner","XHRPromise","method","url","data","xhr","XMLHttpRequest","Promise","resolve","reject","onreadystatechange","readyState","DONE","status","response","JSON","parse","responseText","text","error","open","setRequestHeader","send","getXHRPromise","queryString","Object","keys","map","k","encodeURIComponent","postXHRPromise","formData","FormData","entries","key","value","append","csrfTokenName","csrfTokenValue","refreshPageOnUpload","showMediaUploadForm","routes","adminMediaUploadFormGet","then","mediaUpload","adminMediaUploadFile","location","reload","catch","console","log","upload","saveMedia","formButton","adminMediaSave","deleteMedia","deleteMediaPrompt"],"mappings":"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","file":"media.js","sourceRoot":"..","sourcesContent":["/**\n * Enable Form Control\n *\n * @param {object} control Control button element\n */\nconst enableFormControl = function(control) {\n    if (control && control.disabled) {\n        control.disabled = false;\n    }\n}\n\n/**\n * Disable Form Control\n *\n * @param {object} control Control button element\n */\nconst disableFormControl =  function(control) {\n    if (control && !control.disabled) {\n        control.disabled = true;\n    }\n}\n\nexport { enableFormControl, disableFormControl };","/**\n * Dismiss Inline Alert\n * @param {Event} event\n */\nconst dismissAlertInlineMessage = function(event) {\n    if (event.target.dataset.dismiss === \"alert\") {\n        event.target.closest(`[data-alert=\"container\"]`).remove();\n    }\n}\n\n/**\n * Display Inline HTML Message Alert\n * @param {string} severity Severity color code\n * @param {string} heading  Message heading\n * @param {mixed} message   Message list\n */\nconst alertInlineMessage = function(severity, heading, message) {\n    // Create element and insert alert HTML and update with alert data\n    let container = document.createElement(\"div\");\n    container.innerHTML = pitonConfig.alertInlineHTML;\n    container.querySelector(`[data-alert=\"container\"]`).classList.add(\"alert-\" + severity);\n    container.querySelector(`[data-alert=\"heading\"]`).innerHTML = heading;\n\n    // Stringify message\n    if (typeof message === 'object') {\n        message = message.join(\"<br>\");\n    } else if (typeof message === 'undefined') {\n        message = \"\";\n    }\n\n    container.querySelector(`[data-alert=\"content\"]`).innerHTML = message;\n\n    // Insert into main or body\n    let mainContainer = document.querySelector(\"main.main-content\");\n    mainContainer.insertAdjacentHTML('afterbegin', container.innerHTML);\n    window.scrollTo(0,0);\n}\n\nexport { alertInlineMessage, dismissAlertInlineMessage };","/**\n * Collapse Toggle\n * @param {Event} event\n */\nconst collapseToggle = function(event) {\n    if (event.target.dataset.collapse === 'toggle') {\n        let collapseTarget = event.target.closest(`[data-collapse=\"parent\"]`).querySelector(`[data-collapse=\"target\"]`);\n\n        if (collapseTarget) {\n            collapseTarget.classList.toggle(\"collapsed\");\n        }\n    }\n}\n\nexport { collapseToggle };","// --------------------------------------------------------\n// Main JS\n// --------------------------------------------------------\n\nimport { enableFormControl, disableFormControl } from './formControl.js';\nimport { dismissAlertInlineMessage } from './alert.js';\nimport { collapseToggle } from './collapse.js';\n\n// Form Control Events\ndocument.querySelectorAll(\"form\").forEach(form => {\n    // Disable form controls and listen for form input changes to re-enable save controls\n    let saveButtons = form.querySelectorAll(`[data-form-button=\"save\"]`);\n    if (saveButtons) {\n        saveButtons.forEach(control => {\n            disableFormControl(control);\n        });\n\n        // Listen for form changes to reenable controls\n        form.addEventListener(\"input\", (e) => {\n            saveButtons.forEach(control => {\n                enableFormControl(control);\n            });\n        }, false);\n    }\n\n    // Confirm discard of changes\n    form.querySelectorAll(`[data-form-button=\"cancel\"]`).forEach(control => {\n        control.addEventListener(\"click\", (e) => {\n            let userResponse = confirm(\"Click Ok to discard your changes, or cancel continue editing?\");\n            if (!userResponse) e.preventDefault();\n        }, false);\n    });\n\n    // Confirm delete\n    form.querySelectorAll(`[data-delete-prompt]`).forEach(control => {\n        control.addEventListener(\"click\", (e) => {\n            if (!confirm(e.target.dataset.deletePrompt)) e.preventDefault();\n        }, false);\n    });\n});\n\n// Binding click events to document\ndocument.addEventListener(\"click\", dismissAlertInlineMessage, false);\ndocument.addEventListener(\"click\", collapseToggle, false);","// Get base modal HTML available in all pages\nconst modal = document.getElementById(\"modal\");\n\n/**\n * Get Modal\n * Returns modal object\n */\nconst getModal = function() {\n    return modal;\n}\n\n/**\n * Show Modal (Background)\n * Call first if request requires processing time before content is available\n */\nconst showModal = function() {\n    modal.classList.remove(\"d-none\");\n}\n\n/**\n * Load Modal Content and Display\n * @param {string} header\n * @param {string} body\n */\nconst showModalContent = function(header, body) {\n    // Assign modal header and content\n    modal.querySelector(`[data-modal=\"header\"]`).innerHTML = header;\n    modal.querySelector(`[data-modal=\"body\"]`).innerHTML = body;\n\n    // Remove d-none to display\n    modal.classList.remove(\"d-none\");\n    modal.querySelector(`[data-modal=\"content\"]`).classList.remove(\"d-none\");\n}\n\n/**\n * Hide Modal and Clear Contents\n */\nconst hideModal = function() {\n    modal.classList.add(\"d-none\");\n    modal.querySelector(`[data-modal=\"content\"]`).classList.add(\"d-none\");\n    modal.querySelector(`[data-modal=\"header\"]`).innerHTML = \"\";\n    modal.querySelector(`[data-modal=\"body\"]`).innerHTML = \"\";\n}\n\n// Bind close modal events\nmodal.querySelector(`[data-dismiss=\"modal\"]`).addEventListener(\"click\", () => {\n    hideModal();\n}, false);\n\nwindow.addEventListener(\"click\", (event) => {\n    if (event.target === modal) {\n        hideModal();\n    }\n}, false);\n\nexport { getModal, showModal, showModalContent, hideModal };\n","/**\n * Enable Spinner Overlay\n * @param {void}\n */\nconst enableSpinner = function() {\n    if (document.querySelector(\"body > .spinner\").classList.contains(\"d-none\")) {\n        document.querySelector(\"body > .spinner\").classList.remove(\"d-none\")\n    }\n}\n\n/**\n * Disable Spinner Overlay\n * @param {void}\n */\nconst disableSpinner = function() {\n    if (!document.querySelector(\"body > .spinner\").classList.contains(\"d-none\")) {\n        document.querySelector(\"body > .spinner\").classList.add(\"d-none\")\n    }\n}\n\nexport { enableSpinner, disableSpinner };","import { alertInlineMessage } from './alert.js';\nimport { disableSpinner } from './spinner.js';\n\n/**\n * XHR Request Promise\n * @param {string} method \"GET\"|\"POST\"\n * @param {string} url    Resource request URL\n * @param {FormData} data   FormData payload to send\n */\nconst XHRPromise = function(method, url, data) {\n    let xhr = new XMLHttpRequest();\n\n    return new Promise((resolve, reject) => {\n        xhr.onreadystatechange = () => {\n            if (xhr.readyState !== XMLHttpRequest.DONE) return;\n\n            try {\n                if (xhr.status === 200) {\n                    // Successful server response\n                    let response = JSON.parse(xhr.responseText);\n                    if (response.status === \"success\") {\n                        // Response content successful\n                        resolve(response.text);\n                        disableSpinner();\n                    } else {\n                        // Response successful but application failed\n                        reject(alertInlineMessage('danger', 'Failed', [response.text]));\n                        disableSpinner();\n                    }\n                } else {\n                    // Failed server runtime response\n                    reject(alertInlineMessage('danger', 'Failed', [response.text]));\n                    disableSpinner();\n                }\n            } catch (error) {\n                reject(alertInlineMessage('danger', 'Error', [error]));\n                disableSpinner();\n            }\n        }\n\n        // Setup and send\n        xhr.open(method, url, true);\n        xhr.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n        xhr.send(data);\n    });\n}\n\n/**\n * GET XHR Promise Request\n * @param {string} url  Resource URL\n * @param {object} data Object with query string parameters as key: values\n */\nconst getXHRPromise = function(url, data) {\n    let queryString;\n\n    if (data) {\n        queryString = Object.keys(data).map((k) => {\n            return encodeURIComponent(k) + '=' + encodeURIComponent(data[k])\n        }).join('&');\n    }\n\n    // Attach query string to URL\n    if (queryString) {\n        url += '?' + queryString;\n    }\n\n    return XHRPromise(\"GET\", url);\n}\n\n/**\n * POST XHR Promise Request\n * @param {string} url  Resource URL\n * @param {object} data Object with key: values, or FormData instance\n */\nconst postXHRPromise = function(url, data) {\n    let formData;\n    if (data instanceof FormData) {\n        formData = data;\n    } else {\n        formData = new FormData();\n        for (let [key, value] of Object.entries(data)) {\n            formData.append(key, value);\n        }\n    }\n\n    data.append(pitonConfig.csrfTokenName, pitonConfig.csrfTokenValue);\n\n    return XHRPromise(\"POST\", url,  formData);\n}\n\nexport { getXHRPromise, postXHRPromise };\n","// --------------------------------------------------------\n// Upload media\n// --------------------------------------------------------\n\nimport { showModal, showModalContent, hideModal } from './modal.js';\nimport { enableSpinner, disableSpinner } from './spinner.js';\nimport { getXHRPromise, postXHRPromise } from './xhrPromise.js';\nimport { alertInlineMessage } from './alert.js';\n\n// Flag to reload page after upload, or asynchronously\nconst refreshPageOnUpload = document.querySelector(`[data-media-refresh=\"true\"]`) ? true : false;\n\n/**\n * Show Media Upload Form in Modal\n */\nconst showMediaUploadForm = function() {\n    // Get file upload form with most current list of categories\n    showModal();\n    getXHRPromise(pitonConfig.routes.adminMediaUploadFormGet)\n        .then(data => {\n            showModalContent(\"Upload Media\", data);\n        });\n}\n\n/**\n * Media Upload\n * @param {Event} event\n */\nconst mediaUpload = function(event) {\n    if (event.target.dataset.mediaUpload !== \"file\") return;\n\n    enableSpinner();\n    const form = document.querySelector(`form[data-media-upload=\"form\"]`);\n\n    postXHRPromise(pitonConfig.routes.adminMediaUploadFile, new FormData(form))\n        .then(() => {\n            if (refreshPageOnUpload) {\n                window.location.reload();\n            }\n        })\n        .then(() => {\n            hideModal();\n        })\n        .then(() => {\n            disableSpinner();\n        })\n        .catch((text) => {\n            console.log(\"Failed to upload file: \", text);\n            alertInlineMessage('danger', 'Failed to Upload File', text);\n            hideModal();\n            disableSpinner();\n        });\n}\n\n// Bind page events\ndocument.addEventListener(\"click\", mediaUpload, false);\ndocument.querySelectorAll(`[data-media-upload=\"form\"]`)?.forEach(upload => {\n    upload.addEventListener(\"click\", showMediaUploadForm, false);\n});\n","// --------------------------------------------------------\n// Media management\n// --------------------------------------------------------\n\nimport './modules/main.js';\nimport './modules/mediaUpload.js';\nimport { enableSpinner, disableSpinner } from './modules/spinner.js';\nimport { getXHRPromise, postXHRPromise } from './modules/xhrPromise.js';\nimport { alertInlineMessage } from './modules/alert.js';\n\n/**\n * Save Media\n * @param {Event} event\n */\nconst saveMedia = function(event) {\n    if (event.target.dataset.formButton !== \"save\") return;\n    const form = event.target.closest(\"form\");\n\n    postXHRPromise(pitonConfig.routes.adminMediaSave, new FormData(form))\n        .then(() => {\n            // Show save complete by disabling save button again\n            let button = form.querySelector(`[data-form-button=\"save\"]`);\n            button.disabled = true;\n        })\n        .then(() => {\n            disableSpinner();\n        })\n        .catch((text) => {\n            console.log(\"Failed to save media: \", text);\n            alertInlineMessage('danger', 'Failed to Save Media', text);\n            disableSpinner();\n        });\n}\n\nconst deleteMedia = function(event) {\n    if (!event.target.dataset.deleteMediaPrompt) return;\n    if (!confirm(event.target.dataset.deleteMediaPrompt)) return;\n\n        console.log(\"delete me\")\n\n\n}\n\ndocument.addEventListener(\"click\", saveMedia, false);\ndocument.addEventListener(\"click\", deleteMedia, false);\n"]}