{#
  Setting Form Input Macros
#}

{# Wrapper Macro #}
{% macro settingInput(setting) %}
{% import _self as input %}
{% if setting.input_type == 'select' %}
{{ input.selectHtml(setting) }}
{% elseif setting.input_type == 'textarea' %}
{{ input.textareaHtml(setting) }}
{% elseif setting.input_type == 'media' %}
{{ input.mediaInputHtml(setting) }}
{% else %}
{{ input.inputHtml(setting) }}
{% endif %}
{% endmacro settingInput %}

{# Input Macro #}
{% macro inputHtml(setting) %}
{% import _self as status %}
{% set arrayKey = setting.id ?? uniqueKey() %}
<div class="form-group-pageEdit jsSettingParent" id="page-setting-{{ setting.setting_key }}">
  <label>{{ setting.label }}</label> {{ status.flag(setting.status, arrayKey) }}
  <input type="hidden" name="setting[{{ arrayKey }}][id]" value="{{ setting.id }}">
  <input type="hidden" name="setting[{{ arrayKey }}][category]" value="{{ setting.category }}">
  <input type="hidden" name="setting[{{ arrayKey }}][setting_key]" value="{{ setting.setting_key }}">
  <input type="text" class="form-control" name="setting[{{ arrayKey }}][setting_value]" value="{{ setting.setting_value }}" autocomplete="off">
  <small class="form-text text-muted">Key: <code>{{ setting.setting_key }}</code>. {{ setting.help }}</small>

</div>
{% endmacro inputHtml %}

{# Media Input Macro #}
{% macro mediaInputHtml(setting) %}
{% import _self as status %}
{% set arrayKey = setting.id ?? uniqueKey() %}
<div class="form-group-pageEdit jsSettingParent jsMediaInput" id="page-setting-{{ setting.setting_key }}">
  
    <label>{{ setting.label }}</label> {{ status.flag(setting.status, arrayKey) }}
    <input type="hidden" name="setting[{{ arrayKey }}][id]" value="{{ setting.id }}">
    <input type="hidden" name="setting[{{ arrayKey }}][category]" value="{{ setting.category }}">
    <input type="hidden" name="setting[{{ arrayKey }}][setting_key]" value="{{ setting.setting_key }}">
    <input type="hidden" name="setting[{{ arrayKey }}][type]" value="media">
 
  
      <img src="{{ getMediaPath(setting.setting_value, 'large') }}"
        class="img-fluid {% if setting.setting_value %}d-block{% else %}d-none{% endif %}">
      <div class="input-group">
        <div class="input-group-prepend">
          <button class="btn btn-outline-info jsSelectMediaFile" type="button">Select</button>
        </div>
        <input type="text" class="form-control jsMediaInputField" name="setting[{{ arrayKey }}][setting_value]"
          value="{{ getMediaPath(setting.setting_value) }}" autocomplete="off">
        <div class="input-group-append">
          <button class="btn btn-light jsMediaClear" type="button">Clear</button>
        </div>
      </div>
      <small class="form-text text-muted">Key: <code>{{ setting.setting_key }}</code>. {{ setting.help }}</small>
   
</div>
{% endmacro mediaInputHtml %}

{# Select List Macro #}
{% macro selectHtml(setting) %}
{% import _self as status %}
{% set arrayKey = setting.id ?? uniqueKey() %}
<div class="form-group-pageEdit jsSettingParent" id="page-setting-{{ setting.setting_key }}">
 
    <label>{{ setting.label }}</label> {{ status.flag(setting.status, arrayKey) }}
    <input type="hidden" name="setting[{{ arrayKey }}][id]" value="{{ setting.id }}">
    <input type="hidden" name="setting[{{ arrayKey }}][category]" value="{{ setting.category }}">
    <input type="hidden" name="setting[{{ arrayKey }}][setting_key]" value="{{ setting.setting_key }}">
 
  
      <select class="form-control" name="setting[{{ arrayKey }}][setting_value]">
        {% for key, option in setting.options %}
        <option value="{{ key }}" {% if key == setting.setting_value %}selected{% endif %}>{{ option }}</option>
        {% endfor %}
      </select>
      <small class="form-text text-muted">Key: <code>{{ setting.setting_key }}</code>. {{ setting.help }}</small>
  
</div>
{% endmacro selectHtml %}

{# Textarea Macro #}
{% macro textareaHtml(setting) %}
{% import _self as status %}
{% set arrayKey = setting.id ?? uniqueKey() %}
<div class="form-group-pageEdit jsSettingParent" id="page-setting-{{ setting.setting_key }}">

    <label>{{ setting.label }}</label> {{ status.flag(setting.status, arrayKey) }}
    <input type="hidden" name="setting[{{ arrayKey }}][id]" value="{{ setting.id }}">
    <input type="hidden" name="setting[{{ arrayKey }}][category]" value="{{ setting.category }}">
    <input type="hidden" name="setting[{{ arrayKey }}][setting_key]" value="{{ setting.setting_key }}">


      <textarea class="form-control" rows="3"
        name="setting[{{ arrayKey }}][setting_value]">{{ setting.setting_value }}</textarea>
      <small class="form-text text-muted">Key: <code>{{ setting.setting_key }}</code>. {{ setting.help }}</small>
</div>
{% endmacro textareaHtml %}

{# Setting Status #}
{% macro flag(status, key) %}
{% if status == 'orphaned' %}
<span class="badge badge-danger">Orphaned</span>
<div class="form-check">
  <input class="form-check-input" name="setting[{{ key }}][delete]" type="checkbox" value="delete"
    title="Deletes on save">
  <label class="text-danger">Delete?</label>
</div>
{% elseif status == 'new' %}
<span class="badge badge-success">New</span>
{% endif %}
{% endmacro flag %}