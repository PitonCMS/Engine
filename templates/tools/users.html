{% extends '@admin/_adminBase.html' %}
{% import _self as form %}

{% block htmlTitle 'Users' %}
{% block headText %}Manage Users{% endblock %}
{% block sectionId 'detailPage' %}

{% block openForm %}
<form class="contentWrapper jsUserForm" action="{{ pathFor('adminUserSave') }}" method="post" accept-charset="utf-8">
  <input type="hidden" name="{{ site.csrf.name }}" value="{{ site.csrf.value }}">
  {% endblock openForm %}

  {% block sidebar %}
  {# {% include "@admin/tools/_toolsSidebar.html" %} #}

  <div class="button-group sidebar-controls span">

      <button type="button" class="btn btn-outline-success jsAddUserRow">Add User</button>
      <button type="submit" name="button" class="btn btn-outline-primary">Save User(s)</button>
      <a class="btn btn-outline-warning" href="{{ pathFor('adminUser') }}">Cancel</a>


  </div>

  {% endblock sidebar %}

  {% block content %}
  {% if page.recommendRecoveryEmail %}
  <p>You only have one Administrator email registered. You should consider adding a second Administrator recovery email
    address.</p>
  {% endif %}

  <div class="grid-wrapper">
    {% for user in page.users %}
    {% set arrayKey = uniqueKey() %}
    <div class="user-element-block jsUser">
      <div class="form-group">
        <input type="hidden" name="user_id[{{ arrayKey }}]" value="{{ user.id }}">
        <input type="email" class="form-control" name="email[{{ arrayKey }}]" maxlength="255" value="{{ user.email }}" autocomplete="off" {% if user.id %}required{% endif %} {% if user.active == 'N' %}readonly{% endif %}>
      </div>

      <div class="form-group form-check">
        <input class="form-check-input" type="checkbox" name="admin[{{ arrayKey }}]" id="admin-{{ arrayKey }}" {{ checked(user.role == 'A') }}>
        <label class="form-check-label" for="admin-{{ arrayKey }}">Administrator</label>
      </div>

      <button class="btn btn-outline-{% if user.active == 'Y' %}danger{% else %}success{% endif %} ml-2" formaction="{{ pathFor('adminUserStatusUpdate', {'id': user.id, 'status': (user.active == 'N') ? 'Y' : 'N'}) }}">
        {% if user.active == 'Y' %}Deactivate{% else %}Activate{% endif %}
      </button>
    </div>
    {% endfor %}
  </div>
  {% endblock content %}

{% block foot %}
	<script src="{{ basePath() }}/admin/js/user.js"></script>
{% endblock foot %}