{% extends '@admin/_adminBase.html' %}
{% import _self as form %}

{% block htmlTitle 'Users' %}


{% block contentHeader %}
<form class="jsUserForm" action="{{ pathFor('adminToolUserSave') }}" method="post" accept-charset="utf-8">
 <input type="hidden" name="{{ site.csrf.name }}" value="{{ site.csrf.value }}">
 <div class="content-header-inner">
  <div class="breadcrumb"></div>
  <h3 class="section-title">User Settings</h3>
  <div class="btn-group">
   <a class="btn btn-cancel btn-sm" href="{{ pathFor('adminToolUser') }}">Cancel</a>
   <button type="button" class="btn btn-add btn-sm jsAddUserRow">Add User</button>
   <button type="submit" name="button" class="btn btn-save btn-sm">Save User(s)</button>
  </div>
 </div>

 {% endblock contentHeader %}

 {% block content %}
 <div class="content-block">
  {% if page.recommendRecoveryEmail %}
  <div class="one-admin-notice span">

   <p>You only have one Administrator email registered. You should consider adding a second Administrator recovery email
    address.</p>

  </div>
  {% endif %}



  {% for user in page.users %}
  {% set arrayKey = uniqueKey() %}
  <div class="user-card jsUser">

   <input type="hidden" name="user_id[{{ arrayKey }}]" value="{{ user.id }}">

   <!-- Email Input -->
   <input type="email" class="form-control" name="email[{{ arrayKey }}]" maxlength="255" value="{{ user.email }}"
    autocomplete="off" {% if user.id %}required{% endif %} {% if user.active == 'N' %}readonly{% endif %}>

   <div class="form-check">
    <input class="form-check-input" type="checkbox" name="admin[{{ arrayKey }}]" id="admin-{{ arrayKey }}"
     {{ checked(user.role == 'A') }}>
    <label class="form-check-label" for="admin-{{ arrayKey }}">Administrator</label>
   </div>

   <button class="btn btn-{% if user.active == 'Y' %}danger{% else %}success{% endif %}"
    formaction="{{ pathFor('adminToolUserStatusUpdate', {'id': user.id, 'status': (user.active == 'N') ? 'Y' : 'N'}) }}">
    {% if user.active == 'Y' %}Deactivate{% else %}Activate{% endif %}
   </button>

  </div>
  {% endfor %}

 </div>
</form>
{% endblock content %}

{% block foot %}
<script src="{{ basePath() }}/admin/js/user.js"></script>
{% endblock foot %}